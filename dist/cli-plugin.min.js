"use strict";var cliPlugin={index:0,history:[],commands:{},settings:{textColor:"rgba(245, 245, 245, 1)",cursorColor:"rgba(245, 245, 245, 0.75)",backgroundColor:"rgba(51, 51, 51, 0.75)"},init:function(e){Object.assign(cliPlugin.settings,e),cliPlugin.createElements(),cliPlugin.addKeyListeners(),cliPlugin.focusInputElement()},createElements:function(){cliPlugin.containerElement=document.createElement("div"),cliPlugin.containerElement.setAttribute("class","cli-plugin"),cliPlugin.containerElement.setAttribute("style","background:"+cliPlugin.settings.backgroundColor),document.body.appendChild(cliPlugin.containerElement),cliPlugin.outputElement=document.createElement("div"),cliPlugin.outputElement.setAttribute("class","output"),cliPlugin.outputElement.setAttribute("style","color:"+cliPlugin.settings.textColor),cliPlugin.containerElement.appendChild(cliPlugin.outputElement),cliPlugin.inputElement=document.createElement("div"),cliPlugin.inputElement.setAttribute("class","input"),cliPlugin.inputElement.setAttribute("style","text-shadow: 0 0 0 "+cliPlugin.settings.textColor),cliPlugin.inputElement.setAttribute("contenteditable","true"),cliPlugin.inputElement.setAttribute("tabindex","0"),cliPlugin.inputElement.setAttribute("autocomplete","off"),cliPlugin.inputElement.setAttribute("autocorrect","off"),cliPlugin.inputElement.setAttribute("autocapitalize","off"),cliPlugin.inputElement.setAttribute("spellcheck","false"),cliPlugin.containerElement.appendChild(cliPlugin.inputElement),cliPlugin.cursorElement=document.createElement("div"),cliPlugin.cursorElement.setAttribute("class","cursor"),cliPlugin.cursorElement.setAttribute("style","background:"+cliPlugin.settings.cursorColor),cliPlugin.inputElement.appendChild(cliPlugin.cursorElement)},addKeyListeners:function(){document.addEventListener("keydown",cliPlugin.registerEvent,!1),cliPlugin.inputElement.addEventListener("blur",cliPlugin.focusInputElement,!1)},removeKeyListeners:function(){document.removeEventListener("keydown",cliPlugin.registerEvent),cliPlugin.inputElement.removeEventListener("blur",cliPlugin.focusInputElement)},registerEvent:function(e){13===e.keyCode?(e.preventDefault(),cliPlugin.exec()):38===e.keyCode?(e.preventDefault(),cliPlugin.getPrevCmd(),cliPlugin.moveCursorBack()):40===e.keyCode?(e.preventDefault(),cliPlugin.getNextCmd(),cliPlugin.moveCursorBack()):[33,34,35,36,37,39].indexOf(e.keyCode)>-1&&e.preventDefault(),cliPlugin.setActiveState()},exec:function(){var e=cliPlugin.inputElement.textContent.trim();e&&cliPlugin.inputElement.removeChild(cliPlugin.inputElement.firstChild),cliPlugin.history.push(e),cliPlugin.index=cliPlugin.history.length,cliPlugin.print(e),"function"==typeof cliPlugin.commands[e]&&cliPlugin.commands[e]()},getPrevCmd:function(){for(var e=0===cliPlugin.index&&cliPlugin.history.length>0?cliPlugin.history[0]:"";0===e.length&&cliPlugin.index>0;)e=cliPlugin.history[--cliPlugin.index];cliPlugin.inputElement.innerHTML=e},getNextCmd:function(){for(var e="";0===e.length&&cliPlugin.index<cliPlugin.history.length;)e=cliPlugin.history[++cliPlugin.index]||"";cliPlugin.inputElement.innerHTML=e},focusInputElement:function(){cliPlugin.inputElement.focus()},setActiveState:function(){cliPlugin.inputElement.classList.add("active"),window.clearTimeout(cliPlugin.eventTimeoutId),cliPlugin.eventTimeoutId=window.setTimeout(function(){cliPlugin.inputElement.classList.remove("active")},1e3)},moveCursorBack:function(){var e,t;document.createRange?(e=document.createRange(),e.selectNodeContents(cliPlugin.inputElement),e.collapse(!1),t=window.getSelection(),t.removeAllRanges(),t.addRange(e)):document.selection&&(e=document.body.createTextRange(),e.moveToElementText(contentEditableElement),e.collapse(!1),e.select())},bind:function(e,t){cliPlugin.commands[e]=t},unbind:function(e){delete cliPlugin.commands[e]},print:function(e){var t=document.createElement("div");t.innerHTML=e?e:"&#8203;",cliPlugin.outputElement.appendChild(t)},clear:function(){cliPlugin.outputElement.innerHTML=""},destroy:function(){cliPlugin.removeKeyListeners(),cliPlugin.containerElement.parentNode.removeChild(cliPlugin.containerElement)}};